DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨˜æ†¶é…å°éŠæˆ²</title>
    <!-- è¼‰å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* å®šç¾©å¡ç‰‡ç¿»è½‰æ•ˆæœ */
        .card-inner {
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }
        .is-flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-face, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 0.75rem; /* rounded-xl */
        }
        .card-face {
            transform: rotateY(180deg);
            background-color: #f3f4f6; /* bg-gray-100 */
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'å¾®è»Ÿæ­£é»‘é«”', 'sans-serif'],
                    },
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 flex flex-col items-center justify-center min-h-screen p-4 font-sans">

    <div class="w-full max-w-lg mx-auto bg-white shadow-2xl rounded-2xl p-6 md:p-8">
        <h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">å°å°ç¢°è¨˜æ†¶æŒ‘æˆ°</h1>
        
        <!-- è³‡è¨Šé¢æ¿ -->
        <div class="flex justify-between items-center mb-6 p-3 bg-indigo-50 rounded-lg shadow-inner">
            <div id="time" class="text-lg font-medium text-gray-800">æ™‚é–“: 0s</div>
            <div id="moves" class="text-lg font-medium text-gray-800">æ­¥æ•¸: 0</div>
        </div>

        <!-- éŠæˆ²æ¿ -->
        <div id="game-board" class="grid grid-cols-4 gap-3 md:gap-4 aspect-square">
            <!-- å¡ç‰‡å°‡ç”± JavaScript ç”¢ç”Ÿ -->
        </div>

        <!-- æŒ‰éˆ•èˆ‡éŠæˆ²ç‹€æ…‹è¨Šæ¯ -->
        <div class="mt-8 text-center">
            <button id="reset-button" class="w-full py-3 px-6 bg-indigo-600 text-white font-semibold rounded-xl shadow-lg hover:bg-indigo-700 transition duration-300 transform hover:scale-[1.02] active:scale-95">
                é‡æ–°é–‹å§‹
            </button>
            <div id="game-message" class="mt-4 text-xl font-bold text-green-600 hidden">æ­å–œä½ å®ŒæˆæŒ‘æˆ°ï¼</div>
        </div>
    </div>

    <script>
        // ä½¿ç”¨çš„è¡¨æƒ…ç¬¦è™Ÿï¼Œéœ€è¦æ˜¯æˆå°çš„
        const cardFaces = [
            'ğŸš€', 'ğŸ’¡', 'ğŸŒŸ', 'ğŸ©', 
            'ğŸ”', 'ğŸ•', 'ğŸ’»', 'ğŸ’',
            'ğŸš€', 'ğŸ’¡', 'ğŸŒŸ', 'ğŸ©', 
            'ğŸ”', 'ğŸ•', 'ğŸ’»', 'ğŸ’'
        ];

        let board = document.getElementById('game-board');
        let timeElement = document.getElementById('time');
        let movesElement = document.getElementById('moves');
        let messageElement = document.getElementById('game-message');
        let resetButton = document.getElementById('reset-button');

        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let moves = 0;
        let timer = null;
        let timeElapsed = 0;
        let isProcessing = false; // ç”¨æ–¼é˜²æ­¢åœ¨å¡ç‰‡æ¯”å°å‹•ç•«æœŸé–“é»æ“Š

        // --- æ ¸å¿ƒéŠæˆ²é‚è¼¯ ---

        /**
         * Fisher-Yates æ´—ç‰Œç®—æ³•
         * @param {Array} array è¦æ´—ç‰Œçš„é™£åˆ—
         * @returns {Array} æ´—ç‰Œå¾Œçš„é™£åˆ—
         */
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        /**
         * åˆå§‹åŒ–éŠæˆ²æ¿
         */
        function createBoard() {
            // æ¸…ç©ºèˆŠçš„å¡ç‰‡
            board.innerHTML = '';
            
            // è¤‡è£½ä¸¦æ´—ç‰Œå¡ç‰‡å…§å®¹
            const shuffledFaces = shuffle([...cardFaces]);
            
            // é‡ç½®éŠæˆ²ç‹€æ…‹
            cards = [];
            flippedCards = [];
            matchedPairs = 0;
            moves = 0;
            timeElapsed = 0;
            isProcessing = false;
            
            // æ›´æ–° UI
            movesElement.textContent = `æ­¥æ•¸: 0`;
            messageElement.classList.add('hidden');
            
            // å‰µå»ºå¡ç‰‡å…ƒç´ 
            shuffledFaces.forEach((face, index) => {
                // å¡ç‰‡å®¹å™¨
                const card = document.createElement('div');
                card.classList.add('card', 'h-full', 'perspective', 'cursor-pointer');
                card.dataset.index = index;
                
                // å…§å±¤ç¿»è½‰å®¹å™¨
                const cardInner = document.createElement('div');
                cardInner.classList.add('card-inner', 'w-full', 'h-full', 'relative');
                
                // å¡ç‰‡èƒŒé¢
                const cardBack = document.createElement('div');
                cardBack.classList.add('card-back', 'bg-indigo-400', 'shadow-md', 'text-2xl', 'text-white', 'font-bold', 'hover:bg-indigo-500', 'transition', 'duration-150');
                cardBack.textContent = '?'; 
                
                // å¡ç‰‡æ­£é¢
                const cardFace = document.createElement('div');
                cardFace.classList.add('card-face', 'shadow-inner', 'text-4xl', 'md:text-5xl');
                cardFace.textContent = face;
                cardFace.dataset.value = face;

                cardInner.appendChild(cardBack);
                cardInner.appendChild(cardFace);
                card.appendChild(cardInner);
                
                card.addEventListener('click', () => flipCard(card));
                
                board.appendChild(card);
                cards.push({ element: card, value: face, isMatched: false, isFlipped: false });
            });
            
            // å•Ÿå‹•è¨ˆæ™‚å™¨
            startTimer();
        }
        
        /**
         * å•Ÿå‹•/é‡è¨­è¨ˆæ™‚å™¨
         */
        function startTimer() {
            if (timer) clearInterval(timer);
            timeElapsed = 0;
            timeElement.textContent = `æ™‚é–“: 0s`;
            
            timer = setInterval(() => {
                timeElapsed++;
                timeElement.textContent = `æ™‚é–“: ${timeElapsed}s`;
            }, 1000);
        }
        
        /**
         * è™•ç†å¡ç‰‡é»æ“Šç¿»è½‰é‚è¼¯
         * @param {HTMLElement} cardElement è¢«é»æ“Šçš„å¡ç‰‡ DOM å…ƒç´ 
         */
        function flipCard(cardElement) {
            const cardIndex = parseInt(cardElement.dataset.index);
            const card = cards[cardIndex];

            // æª¢æŸ¥æ˜¯å¦æ­£åœ¨è™•ç†ã€å·²é…å°æˆ–å·²ç¶“ç¿»é¢
            if (isProcessing || card.isMatched || card.isFlipped || flippedCards.length >= 2) {
                return;
            }

            // ç¿»è½‰å¡ç‰‡
            cardElement.classList.add('is-flipped');
            card.isFlipped = true;
            flippedCards.push(card);

            if (flippedCards.length === 2) {
                // å¢åŠ æ­¥æ•¸
                moves++;
                movesElement.textContent = `æ­¥æ•¸: ${moves}`;
                isProcessing = true; // é˜»æ­¢é€²ä¸€æ­¥çš„é»æ“Š
                
                // æª¢æŸ¥æ˜¯å¦é…å°æˆåŠŸ
                checkForMatch();
            }
        }

        /**
         * æª¢æŸ¥å…©å¼µç¿»é–‹çš„å¡ç‰‡æ˜¯å¦é…å°æˆåŠŸ
         */
        function checkForMatch() {
            const [card1, card2] = flippedCards;
            const element1 = card1.element;
            const element2 = card2.element;

            if (card1.value === card2.value) {
                // --- é…å°æˆåŠŸ ---
                
                matchedPairs++;
                card1.isMatched = true;
                card2.isMatched = true;
                
                // è®“é…å°æˆåŠŸçš„å¡ç‰‡ä¿æŒç¿»é¢ï¼Œä¸¦æ·»åŠ è¦–è¦ºæ•ˆæœ
                setTimeout(() => {
                    element1.classList.add('matched', 'pointer-events-none', 'shadow-none', 'opacity-50', 'transition', 'duration-500');
                    element2.classList.add('matched', 'pointer-events-none', 'shadow-none', 'opacity-50', 'transition', 'duration-500');
                    
                    // æ¸…ç©ºæš«å­˜çš„ç¿»è½‰å¡ç‰‡
                    flippedCards = [];
                    isProcessing = false;

                    // æª¢æŸ¥éŠæˆ²æ˜¯å¦çµæŸ
                    if (matchedPairs === cardFaces.length / 2) {
                        gameOver();
                    }
                }, 500);

            } else {
                // --- é…å°å¤±æ•— ---
                
                setTimeout(() => {
                    // ç¿»å›èƒŒé¢
                    element1.classList.remove('is-flipped');
                    element2.classList.remove('is-flipped');
                    card1.isFlipped = false;
                    card2.isFlipped = false;
                    
                    // æ¸…ç©ºæš«å­˜çš„ç¿»è½‰å¡ç‰‡
                    flippedCards = [];
                    isProcessing = false;
                }, 1000); // å»¶é² 1 ç§’å¾Œç¿»å›
            }
        }

        /**
         * éŠæˆ²çµæŸè™•ç†
         */
        function gameOver() {
            clearInterval(timer);
            messageElement.textContent = `æ­å–œï¼ä½ ä»¥ ${timeElapsed} ç§’å’Œ ${moves} æ­¥å®ŒæˆæŒ‘æˆ°ï¼`;
            messageElement.classList.remove('hidden');
        }

        // --- äº‹ä»¶ç›£è½èˆ‡åˆå§‹åŒ– ---

        resetButton.addEventListener('click', createBoard);

        // é¦–æ¬¡è¼‰å…¥æ™‚åˆå§‹åŒ–éŠæˆ²
        createBoard();

    </script>
</body>
</html>

            